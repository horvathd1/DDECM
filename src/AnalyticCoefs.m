function [coefs] = AnalyticCoefs(params)
switch(class(params))
    case 'Param'
        coefs=MachineTool(params.zeta,params.j);
    otherwise
        coefs=DL(params.a,params.b,params.c,params.d,params.tau,params.omega,params.gamma,params.k);
end
end
function coefs=DL(a,b,c,d,tau,omega,gamma,k)
    Omega=4*gamma/(omega^2*(2+k*tau));
    d11= Omega*omega^2*(1+1/2*k*tau);
    d12=Omega*1/2*(k-omega^2*tau);
    d21 = Omega*-omega/2*(k-omega^2*tau);
    d22=Omega*omega*(1+1/2*k*tau);
    coefs=zeros(7,2);
    ord=[5,3,1,7,6,4,2];
    mat10=[(-2/3).*omega.^(-1).*(a.*d21+c.*omega.^2.*((-2).*d12.*k.*omega+ ...
  d22.*(2.*k.^2+omega.^2)))+omega.*(1+4.*k.^2.*omega.^2+16.* ...
  omega.^4+(-8).*omega.^2.*cos(2.*omega.*tau)+(-4).*k.*omega.*sin( ...
  2.*omega.*tau)).^(-1).*(omega.*(4.*a.*k+c.*(k.^2+omega.^2+4.* ...
  k.^4.*omega.^2+(-4).*omega.^4+20.*k.^2.*omega.^4+16.*omega.^6))+( ...
  -1).*c.*omega.*(k.^2+(-1).*omega.^2+8.*k.^2.*omega.^2+8.*omega.^4) ...
  .*cos(2.*omega.*tau)+(-2).*(a+c.*k.*omega.^2.*((-1)+2.*k.^2+2.* ...
  omega.^2)).*sin(2.*omega.*tau)),(2/3).*omega.^(-1).*(a.*d11+c.* ...
  omega.^2.*((-1).*d22.*k.*omega+d12.*((-1).*k.^2+omega.^2)))+ ...
  omega.*(1+4.*k.^2.*omega.^2+16.*omega.^4+(-8).*omega.^2.*cos(2.* ...
  omega.*tau)+(-4).*k.*omega.*sin(2.*omega.*tau)).^(-1).*(2.*(a+(-1) ...
  .*c.*k.*omega.^2).*cos(2.*omega.*tau)+omega.*((-8).*a.*omega+2.* ...
  c.*k.^3.*omega+6.*c.*k.*omega.^3+(-1).*c.*(k.^2+(-1).*omega.^2).* ...
  sin(2.*omega.*tau))),(-2/3).*omega.^(-1).*(2.*a.*d21+c.*omega.^2.* ...
  (2.*d12.*k.*omega+d22.*(k.^2+2.*omega.^2)))+omega.*(1+4.*k.^2.* ...
  omega.^2+16.*omega.^4+(-8).*omega.^2.*cos(2.*omega.*tau)+(-4).*k.* ...
  omega.*sin(2.*omega.*tau)).^(-1).*((-4).*a.*k.*omega+c.*k.^2.* ...
  omega+c.*omega.^3+4.*c.*k.^4.*omega.^3+4.*c.*omega.^5+20.*c.* ...
  k.^2.*omega.^5+16.*c.*omega.^7+(-1).*c.*omega.*(omega.^2+8.* ...
  omega.^4+k.^2.*((-1)+8.*omega.^2)).*cos(2.*omega.*tau)+2.*(a+(-1) ...
  .*c.*k.*omega.^2.*(1+2.*k.^2+2.*omega.^2)).*sin(2.*omega.*tau))];
    mat1t=[(2/3).*omega.^(-1).*(1+4.*k.^2.*omega.^2+16.*omega.^4+(-8).* ...
  omega.^2.*cos(2.*omega.*tau)+(-4).*k.*omega.*sin(2.*omega.*tau)) ...
  .^(-1).*(3.*c.*omega.^5+6.*c.*k.^4.*omega.^5+30.*c.*k.^2.* ...
  omega.^7+24.*c.*omega.^9+(-1).*(a.*(d21+(-2).*d11.*k.*omega+4.* ...
  d21.*((-1)+k.^2).*omega.^2+16.*d21.*omega.^4)+c.*omega.^2.*((-2).* ...
  d12.*k.*omega.*(1+(-3).*omega.^2+16.*omega.^4+k.^2.*(2+4.* ...
  omega.^2))+d22.*(omega.^2+8.*k.^4.*omega.^2+(-4).*omega.^4+16.* ...
  omega.^6+2.*k.^2.*(1+(-6).*omega.^2+18.*omega.^4)))).*cos(omega.* ...
  tau)+6.*omega.^3.*(a.*k+(-2).*c.*k.^2.*omega.^2+(-3).*c.*omega.^4) ...
  .*cos(2.*omega.*tau)+(-2).*a.*d11.*k.*omega.*cos(3.*omega.*tau)+ ...
  4.*a.*d21.*omega.^2.*cos(3.*omega.*tau)+(-4).*c.*d12.*k.^3.* ...
  omega.^3.*cos(3.*omega.*tau)+4.*c.*d22.*k.^2.*omega.^4.*cos(3.* ...
  omega.*tau)+(-10).*c.*d12.*k.*omega.^5.*cos(3.*omega.*tau)+4.*c.* ...
  d22.*omega.^6.*cos(3.*omega.*tau)+(-1).*a.*d11.*sin(omega.*tau)+ ...
  2.*a.*d21.*k.*omega.*sin(omega.*tau)+(-4).*a.*d11.*omega.^2.*sin( ...
  omega.*tau)+(-4).*a.*d11.*k.^2.*omega.^2.*sin(omega.*tau)+(-2).* ...
  c.*d12.*k.^2.*omega.^2.*sin(omega.*tau)+(-2).*c.*d22.*k.* ...
  omega.^3.*sin(omega.*tau)+4.*c.*d22.*k.^3.*omega.^3.*sin(omega.* ...
  tau)+(-16).*a.*d11.*omega.^4.*sin(omega.*tau)+(-1).*c.*d12.* ...
  omega.^4.*sin(omega.*tau)+(-12).*c.*d12.*k.^2.*omega.^4.*sin( ...
  omega.*tau)+(-8).*c.*d12.*k.^4.*omega.^4.*sin(omega.*tau)+(-6).* ...
  c.*d22.*k.*omega.^5.*sin(omega.*tau)+(-8).*c.*d22.*k.^3.* ...
  omega.^5.*sin(omega.*tau)+(-4).*c.*d12.*omega.^6.*sin(omega.*tau)+ ...
  (-36).*c.*d12.*k.^2.*omega.^6.*sin(omega.*tau)+(-32).*c.*d22.*k.* ...
  omega.^7.*sin(omega.*tau)+(-16).*c.*d12.*omega.^8.*sin(omega.*tau) ...
  +(-12).*a.*omega.^4.*sin(2.*omega.*tau)+(-3).*c.*k.^3.*omega.^4.* ...
  sin(2.*omega.*tau)+3.*c.*k.*omega.^6.*sin(2.*omega.*tau)+2.*a.* ...
  d21.*k.*omega.*sin(3.*omega.*tau)+4.*a.*d11.*omega.^2.*sin(3.* ...
  omega.*tau)+4.*c.*d22.*k.^3.*omega.^3.*sin(3.*omega.*tau)+4.*c.* ...
  d12.*k.^2.*omega.^4.*sin(3.*omega.*tau)+10.*c.*d22.*k.*omega.^5.* ...
  sin(3.*omega.*tau)+4.*c.*d12.*omega.^6.*sin(3.*omega.*tau)),(-2/3) ...
  .*omega.^(-1).*(1+4.*k.^2.*omega.^2+16.*omega.^4+(-8).*omega.^2.* ...
  cos(2.*omega.*tau)+(-4).*k.*omega.*sin(2.*omega.*tau)).^(-1).*(( ...
  -3).*a.*omega.^2+3.*c.*k.*omega.^4+((-1).*a.*(d11+2.*d21.*k.* ...
  omega+4.*d11.*((-1)+k.^2).*omega.^2+16.*d11.*omega.^4)+c.* ...
  omega.^2.*(d22.*k.*omega.*(1+(-6).*omega.^2+16.*omega.^4+k.^2.*(2+ ...
  4.*omega.^2))+d12.*((-1).*omega.^2+4.*k.^4.*omega.^2+4.*omega.^4+( ...
  -16).*omega.^6+k.^2.*(1+(-6).*omega.^2+12.*omega.^4)))).*cos( ...
  omega.*tau)+(-3).*omega.^4.*((-4).*a+c.*k.*(k.^2+3.*omega.^2)).* ...
  cos(2.*omega.*tau)+2.*a.*d21.*k.*omega.*cos(3.*omega.*tau)+4.*a.* ...
  d11.*omega.^2.*cos(3.*omega.*tau)+(-2).*c.*d22.*k.^3.*omega.^3.* ...
  cos(3.*omega.*tau)+(-2).*c.*d12.*k.^2.*omega.^4.*cos(3.*omega.* ...
  tau)+(-2).*c.*d22.*k.*omega.^5.*cos(3.*omega.*tau)+4.*c.*d12.* ...
  omega.^6.*cos(3.*omega.*tau)+a.*d21.*sin(omega.*tau)+2.*a.*d11.* ...
  k.*omega.*sin(omega.*tau)+4.*a.*d21.*omega.^2.*sin(omega.*tau)+4.* ...
  a.*d21.*k.^2.*omega.^2.*sin(omega.*tau)+(-1).*c.*d22.*k.^2.* ...
  omega.^2.*sin(omega.*tau)+c.*d12.*k.*omega.^3.*sin(omega.*tau)+( ...
  -2).*c.*d12.*k.^3.*omega.^3.*sin(omega.*tau)+16.*a.*d21.* ...
  omega.^4.*sin(omega.*tau)+c.*d22.*omega.^4.*sin(omega.*tau)+(-6).* ...
  c.*d22.*k.^2.*omega.^4.*sin(omega.*tau)+(-4).*c.*d22.*k.^4.* ...
  omega.^4.*sin(omega.*tau)+6.*c.*d12.*k.*omega.^5.*sin(omega.*tau)+ ...
  4.*c.*d12.*k.^3.*omega.^5.*sin(omega.*tau)+4.*c.*d22.*omega.^6.* ...
  sin(omega.*tau)+(-12).*c.*d22.*k.^2.*omega.^6.*sin(omega.*tau)+ ...
  16.*c.*d12.*k.*omega.^7.*sin(omega.*tau)+16.*c.*d22.*omega.^8.* ...
  sin(omega.*tau)+6.*a.*k.*omega.^3.*sin(2.*omega.*tau)+(-6).*c.* ...
  omega.^7.*sin(2.*omega.*tau)+2.*a.*d11.*k.*omega.*sin(3.*omega.* ...
  tau)+(-4).*a.*d21.*omega.^2.*sin(3.*omega.*tau)+(-2).*c.*d12.* ...
  k.^3.*omega.^3.*sin(3.*omega.*tau)+2.*c.*d22.*k.^2.*omega.^4.*sin( ...
  3.*omega.*tau)+(-2).*c.*d12.*k.*omega.^5.*sin(3.*omega.*tau)+(-4) ...
  .*c.*d22.*omega.^6.*sin(3.*omega.*tau)),(2/3).*omega.^(-1).*(1+4.* ...
  k.^2.*omega.^2+16.*omega.^4+(-8).*omega.^2.*cos(2.*omega.*tau)+( ...
  -4).*k.*omega.*sin(2.*omega.*tau)).^(-1).*(3.*c.*k.^2.*omega.^3+ ...
  6.*c.*k.^4.*omega.^5+30.*c.*k.^2.*omega.^7+24.*c.*omega.^9+(-1).*( ...
  2.*a.*(d21+(-2).*d11.*k.*omega+4.*d21.*((-1)+k.^2).*omega.^2+16.* ...
  d21.*omega.^4)+c.*omega.^2.*(d22.*(k.^2+2.*omega.^2+4.*k.^4.* ...
  omega.^2+(-8).*omega.^4+24.*k.^2.*omega.^4+32.*omega.^6)+2.*d12.* ...
  k.*omega.*(1+(-6).*omega.^2+16.*omega.^4+k.^2.*((-1)+4.*omega.^2)) ...
  )).*cos(omega.*tau)+(-6).*omega.^3.*(a.*k+c.*omega.^2.*(2.*k.^2+ ...
  omega.^2)).*cos(2.*omega.*tau)+(-4).*a.*d11.*k.*omega.*cos(3.* ...
  omega.*tau)+8.*a.*d21.*omega.^2.*cos(3.*omega.*tau)+(-2).*c.*d12.* ...
  k.^3.*omega.^3.*cos(3.*omega.*tau)+8.*c.*d22.*k.^2.*omega.^4.*cos( ...
  3.*omega.*tau)+4.*c.*d12.*k.*omega.^5.*cos(3.*omega.*tau)+8.*c.* ...
  d22.*omega.^6.*cos(3.*omega.*tau)+(-2).*a.*d11.*sin(omega.*tau)+ ...
  4.*a.*d21.*k.*omega.*sin(omega.*tau)+(-8).*a.*d11.*omega.^2.*sin( ...
  omega.*tau)+(-8).*a.*d11.*k.^2.*omega.^2.*sin(omega.*tau)+(-1).* ...
  c.*d12.*k.^2.*omega.^2.*sin(omega.*tau)+2.*c.*d22.*k.*omega.^3.* ...
  sin(omega.*tau)+2.*c.*d22.*k.^3.*omega.^3.*sin(omega.*tau)+(-32).* ...
  a.*d11.*omega.^4.*sin(omega.*tau)+(-2).*c.*d12.*omega.^4.*sin( ...
  omega.*tau)+(-4).*c.*d12.*k.^4.*omega.^4.*sin(omega.*tau)+12.*c.* ...
  d22.*k.*omega.^5.*sin(omega.*tau)+8.*c.*d22.*k.^3.*omega.^5.*sin( ...
  omega.*tau)+(-8).*c.*d12.*omega.^6.*sin(omega.*tau)+(-24).*c.* ...
  d12.*k.^2.*omega.^6.*sin(omega.*tau)+32.*c.*d22.*k.*omega.^7.*sin( ...
  omega.*tau)+(-32).*c.*d12.*omega.^8.*sin(omega.*tau)+12.*a.* ...
  omega.^4.*sin(2.*omega.*tau)+(-9).*c.*k.^3.*omega.^4.*sin(2.* ...
  omega.*tau)+(-15).*c.*k.*omega.^6.*sin(2.*omega.*tau)+4.*a.*d21.* ...
  k.*omega.*sin(3.*omega.*tau)+8.*a.*d11.*omega.^2.*sin(3.*omega.* ...
  tau)+2.*c.*d22.*k.^3.*omega.^3.*sin(3.*omega.*tau)+8.*c.*d12.* ...
  k.^2.*omega.^4.*sin(3.*omega.*tau)+(-4).*c.*d22.*k.*omega.^5.*sin( ...
  3.*omega.*tau)+8.*c.*d12.*omega.^6.*sin(3.*omega.*tau))];
    coefs(ord,1)=[a.*d11+c.*d12.*omega.^4,(-2).*c.*d12.*k.*omega.^3,c.*d12.*k.^2.* ...
  omega.^2,b.*d11+a.*d11.*mat10(1)+c.*d12.*mat1t(1).*omega.^2+d.*d12.* ...
  omega.^6,2.*a.*d11.*mat10(2)+(-1).*c.*d12.*k.*mat1t(1).*omega+2.*c.* ...
  d12.*mat1t(2).*omega.^2+(-3).*d.*d12.*k.*omega.^5,a.*d11.*mat10(3)+(-2) ...
  .*c.*d12.*k.*mat1t(2).*omega+c.*d12.*mat1t(3).*omega.^2+3.*d.*d12.* ...
  k.^2.*omega.^4,(-1).*c.*d12.*k.*mat1t(3).*omega+(-1).*d.*d12.*k.^3.* ...
  omega.^3];
    coefs(ord,2)=[a.*d21+c.*d22.*omega.^4,(-2).*c.*d22.*k.*omega.^3,c.*d22.*k.^2.* ...
  omega.^2,b.*d21+a.*d21.*mat10(1)+c.*d22.*mat1t(1).*omega.^2+d.*d22.* ...
  omega.^6,2.*a.*d21.*mat10(2)+(-1).*c.*d22.*k.*mat1t(1).*omega+2.*c.* ...
  d22.*mat1t(2).*omega.^2+(-3).*d.*d22.*k.*omega.^5,a.*d21.*mat10(3)+(-2) ...
  .*c.*d22.*k.*mat1t(2).*omega+c.*d22.*mat1t(3).*omega.^2+3.*d.*d22.* ...
  k.^2.*omega.^4,(-1).*c.*d22.*k.*mat1t(3).*omega+(-1).*d.*d22.*k.^3.* ...
  omega.^3];
end
function coefs=MachineTool(zeta,j)
param=Param(zeta,j);
p=param.p;
omega=param.omega;
zeta=param.zeta;
tau=param.tau;
gamma=param.gamma;
n1=[2*gamma*(2*zeta^2+2*zeta+1);2*gamma*zeta];
n2=[2*gamma*omega*zeta;2*gamma*omega];
f11=3*zeta/(5*(1+zeta));
f12=-6*zeta*omega/(5*(1+zeta));
f22=3*zeta*omega^2/(5*(1+zeta));
mnsol_A=[0,0,(-2).*omega,0,0,0,(-1).*omega,0,0,0,0,0;0,0,0,(-2).*omega,0, ...
  0,0,(-1).*omega,0,0,0,0;omega,0,0,0,(-1).*omega,0,0,0,(-1).*omega, ...
  0,0,0;0,omega,0,0,0,(-1).*omega,0,0,0,(-1).*omega,0,0;0,0,2.* ...
  omega,0,0,0,0,0,0,0,(-1).*omega,0;0,0,0,2.*omega,0,0,0,0,0,0,0,( ...
  -1).*omega;omega,0,0,0,0,0,0,0,(-2).*omega,0,0,0;0,omega,0,0,0,0, ...
  0,0,0,(-2).*omega,0,0;0,0,omega,0,0,0,omega,0,0,0,(-1).*omega,0;0, ...
  0,0,omega,0,0,0,omega,0,0,0,(-1).*omega;0,0,0,0,omega,0,0,0,2.* ...
  omega,0,0,0;0,0,0,0,0,omega,0,0,0,2.*omega,0,0];
mnsol_B=[(-6/5).*gamma.*zeta.^2.*(1+zeta).^(-1);(-6/5).*gamma.*omega.^2.* ...
  zeta.*(1+zeta).^(-1);(12/5).*gamma.*omega.*zeta.^2.*(1+zeta).^(-1) ...
  ;(12/5).*gamma.*omega.^3.*zeta.*(1+zeta).^(-1);(-6/5).*gamma.* ...
  omega.^2.*zeta.^2.*(1+zeta).^(-1);(-6/5).*gamma.*omega.^4.*zeta.*( ...
  1+zeta).^(-1);(-6/5).*gamma.*omega.*zeta.*(1+zeta).^(-1);(6/5).* ...
  gamma.*omega.*zeta.^2.*(1+zeta).^(-1);(12/5).*gamma.*omega.^2.* ...
  zeta.*(1+zeta).^(-1);(-12/5).*gamma.*omega.^2.*zeta.^2.*(1+zeta) ...
  .^(-1);(-6/5).*gamma.*omega.^3.*zeta.*(1+zeta).^(-1);(6/5).* ...
  gamma.*omega.^3.*zeta.^2.*(1+zeta).^(-1)];
MN=mnsol_A\mnsol_B;
M=MN(1:6);
N=MN(7:12);
ksol_A=[0,1,2.*omega,0,0,0;(-1)+(-1).*p+p.*((1/2)+(1/2).*cos(2.*omega.* ...
  tau)),(-2).*zeta,p.*sin(2.*omega.*tau),2.*omega,p.*((1/2)+(-1/2).* ...
  cos(2.*omega.*tau)),0;(-1).*omega,0,0,1,omega,0;(-1/2).*p.*sin(2.* ...
  omega.*tau),(-1).*omega,(-1)+(-1).*p+p.*cos(2.*omega.*tau),(-2).* ...
  zeta,(1/2).*p.*sin(2.*omega.*tau),omega;0,0,(-2).*omega,0,0,1;p.*( ...
  (1/2)+(-1/2).*cos(2.*omega.*tau)),0,(-1).*p.*sin(2.*omega.*tau),( ...
  -2).*omega,(-1)+(-1).*p+p.*((1/2)+(1/2).*cos(2.*omega.*tau)),(-2) ...
  .*zeta];
ksol_B=[0;(-3/5).*zeta.*(1+zeta).^(-1);0;(6/5).*omega.*zeta.*(1+zeta).^( ...
  -1);0;(-3/5).*omega.^2.*zeta.*(1+zeta).^(-1)];
K=ksol_A\ksol_B;
C=[0,0,(-2).*omega,0,0,0;0,0,0,(-2).*omega,0,0;omega,0,0,0,(-1).* ...
  omega,0;0,omega,0,0,0,(-1).*omega;0,0,2.*omega,0,0,0;0,0,0,2.* ...
  omega,0,0];
eK=expm(-tau*C)*K;
mat10=[K(1)+M(1),K(3)+M(3),K(5)+M(5)];
mat1t=[eK(1)+M(1)*cos(omega*tau)-N(1)*sin(omega*tau),...
    eK(3)+M(3)*cos(omega*tau)-N(3)*sin(omega*tau),...
    eK(5)+M(5)*cos(omega*tau)-N(5)*sin(omega*tau)];
coefs=zeros(7,2);
coefs(:,1)=[(6/5).*gamma.*omega.^2.*zeta.^2.*(1+zeta).^(-1),(-6/5).*gamma.* ...
  mat10(3).*omega.*zeta.^2+(6/5).*gamma.*mat1t(3).*omega.*zeta.^2+(6/5) ...
  .*gamma.*omega.^3.*zeta.^2.*(1+zeta).^(-2),(-12/5).*gamma.*omega.* ...
  zeta.^2.*(1+zeta).^(-1),(6/5).*gamma.*mat10(3).*zeta.^2+(-6/5).* ...
  gamma.*mat1t(3).*zeta.^2+(-12/5).*gamma.*mat10(2).*omega.*zeta.^2+( ...
  12/5).*gamma.*mat1t(2).*omega.*zeta.^2+(-18/5).*gamma.*omega.^2.* ...
  zeta.^2.*(1+zeta).^(-2),(6/5).*gamma.*zeta.^2.*(1+zeta).^(-1),( ...
  12/5).*gamma.*mat10(2).*zeta.^2+(-12/5).*gamma.*mat1t(2).*zeta.^2+( ...
  -6/5).*gamma.*mat10(1).*omega.*zeta.^2+(6/5).*gamma.*mat1t(1).*omega.* ...
  zeta.^2+(18/5).*gamma.*omega.*zeta.^2.*(1+zeta).^(-2),(6/5).* ...
  gamma.*mat10(1).*zeta.^2+(-6/5).*gamma.*mat1t(1).*zeta.^2+(-6/5).* ...
  gamma.*zeta.^2.*(1+zeta).^(-2)];
coefs(:,2)=[(6/5).*gamma.*omega.^3.*zeta.*(1+zeta).^(-1),(-6/5).*gamma.* ...
  mat10(3).*omega.^2.*zeta+(6/5).*gamma.*mat1t(3).*omega.^2.*zeta+(6/5) ...
  .*gamma.*omega.^4.*zeta.*(1+zeta).^(-2),(-12/5).*gamma.*omega.^2.* ...
  zeta.*(1+zeta).^(-1),(6/5).*gamma.*mat10(3).*omega.*zeta+(-6/5).* ...
  gamma.*mat1t(3).*omega.*zeta+(-12/5).*gamma.*mat10(2).*omega.^2.*zeta+ ...
  (12/5).*gamma.*mat1t(2).*omega.^2.*zeta+(-18/5).*gamma.*omega.^3.* ...
  zeta.*(1+zeta).^(-2),(6/5).*gamma.*omega.*zeta.*(1+zeta).^(-1),( ...
  12/5).*gamma.*mat10(2).*omega.*zeta+(-12/5).*gamma.*mat1t(2).*omega.* ...
  zeta+(-6/5).*gamma.*mat10(1).*omega.^2.*zeta+(6/5).*gamma.*mat1t(1).* ...
  omega.^2.*zeta+(18/5).*gamma.*omega.^2.*zeta.*(1+zeta).^(-2),(6/5) ...
  .*gamma.*mat10(1).*omega.*zeta+(-6/5).*gamma.*mat1t(1).*omega.*zeta+( ...
  -6/5).*gamma.*omega.*zeta.*(1+zeta).^(-2)];

end

